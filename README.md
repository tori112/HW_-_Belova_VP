# Микросервисы с RabbitMQ

## Описание проекта

Этот проект представляет собой микросервисную архитектуру для обработки данных с использованием брокера очередей RabbitMQ. Мы реализуем несколько сервисов, которые взаимодействуют между собой для выполнения различных задач обработки данных, предсказания и мониторинга.

## Структура проекта

Проект организован в структуру папок следующим образом:

microservice_architecture/
│
├── features/
│   ├── Dockerfile
│   ├── requirements.txt
│   └── src/
│       └── features.py
│
├── model/
│   ├── Dockerfile
│   ├── requirements.txt
│   └── src/
│       └── model.py
│
├── metric/
│   ├── Dockerfile
│   ├── requirements.txt
│   └── src/
│       └── metric.py
│
├── plot/
│   ├── Dockerfile
│   ├── requirements.txt
│   └── src/
│       └── plot.py
│
└── docker-compose.yml


## Описание сервисов

### 1. Сервис Features

Этот сервис берет случайную строку из датасета и отправляет полученные признаки объекта в одну очередь, а истинный ответ - в другую. Сервис работает в бесконечном цикле и отправляет данные с некоторой задержкой между итерациями.

### 2. Сервис Model

Этот сервис читает признаки из очереди features, делает предсказание и отправляет его в очередь y_pred.

### 3. Сервис Metric

Этот сервис читает очереди с истинными ответами (y_true) и предсказаниями (y_pred), вычисляет абсолютную ошибку и записывает метрики в файл logs/metric_log.csv. Сервис работает постоянно, мониторя поступление сообщений в очереди.

### 4. Сервис Plot

Этот сервис в бесконечном цикле читает таблицу logs/metric_log.csv и строит график распределения (гистограмму) абсолютных ошибок. График записывается в файл logs/error_distribution.png и обновляется с каждой итерацией.

## Инструкции по запуску

1. Клонирование репозитория

    
    git clone [<https://github.com/tori112/HW_-_Belova_VP.git>](https://github.com/tori112/HW_-_Belova_VP.git)
    cd microservice_architecture
    

2. Сборка образов Docker

    В корневой папке проекта выполните команду:

    
    docker-compose build
    

3. Запуск сервисов

    После сборки образов выполните команду:

    
    docker-compose up
    

    Это запустит все сервисы согласно описанным в docker-compose.yml настройкам.

## Логирование

В процессе работы сервисы будут вести логирование метрик в файле logs/metric_log.csv с следующими столбцами:

id, y_true, y_pred, absolute_error


Каждая запись содержит уникальный идентификатор, истинное значение, предсказанное значение и абсолютную ошибку.

## Визуализация ошибок

Сервис plot.py создает и обновляет гистограмму абсолютных ошибок, которая сохраняется в файл logs/error_distribution.png.

## Обработка ошибок

Код каждого сервиса заключен в конструкцию try-except, что позволяет им продолжать работу, даже если произойдет ошибка. В случае ошибки она будет выведена на экран.

## Заключение

Этот проект демонстрирует, как можно использовать микросервисную архитектуру и RabbitMQ для создания распределенной системы обработки данных, предсказаний и мониторинга. Благодаря Docker и Docker Compose, развертывание и управление сервисами упрощается, что позволяет легко масштабировать и модифицировать систему по мере необходимости.